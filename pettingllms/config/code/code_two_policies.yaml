# Configuration for Code multi-agent training with TWO different policies
# code_generator uses Qwen/Qwen2.5-Coder-3B, test_generator uses DeepSeek-R1-Distill

# Inherit from base configuration
defaults:
  # 为两个模型分别注入一份 ppo_trainer/base 子树，彼此独立可覆盖
  - ppo_trainer@models.model_0.ppo_trainer_config: base
  - ppo_trainer@models.model_1.ppo_trainer_config: base
  - _self_

# dataset config (shared by all agents)
data:
  #rollout config
  gen_batch_size: 64
  gen_n_samples: 8
  sample_temperature: 0.7

  # Batch sizes
  train_batch_size: 256
  val_batch_size: 128
  
  # Sequence lengths
  max_prompt_length: 10240
  max_response_length: 2048

resource:
  nnodes: 1
  n_gpus_per_node: 1
  trust_remote_code: true

# Environment configuration (shared by all agents)
env:
  name: code_env
  benchmark: "deepmind/code_contests"
  max_turns: 8
  resolve: false
  multi_modal: false
  batched_init: true

# Multi-agent interaction configuration
multi_agent_interaction:
  
  # Turn order for agents (list of agent names)
  turn_order: ["code_generator", "test_generator"]
  
  # Number of agents that interact per episode
  num_interacting_agents: 2
  
  # Whether agents can see other agents' actions
  shared_observation: true

# Shared model configurations
models:
  model_0:
    path: Qwen/Qwen2.5-0.5B
    name: "code_generator_model"
    ppo_trainer_config:
      actor_rollout_ref:
        model:
          path: ${models.model_0.path}
    # ppo_trainer_config 由 defaults 注入，上面的设置将覆盖base中的默认值
    
  model_1:
    path: Qwen/Qwen2.5-0.5B
    name: "test_generator_model"
    ppo_trainer_config:
      actor_rollout_ref:
        model:
          path: ${models.model_1.path}
    # ppo_trainer_config 由 defaults 注入，上面的设置将覆盖base中的默认值

# Multi-agent configuration for two policies
agent_policy_configs:
  # Number of agents to train
  num_agents: 2
  policy_list: ["code_generator", "test_generator"]
  agent_configs:
    agent_0:
      name: "code_generator"
      policy_name: "code_generator_model"
      
    agent_1:
      name: "test_generator"
      policy_name: "test_generator_model"